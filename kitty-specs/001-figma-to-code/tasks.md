---
description: "Work package task list for Figma-to-Code Rule Builder (Multi-Node Library Manager)"
---
*Path: [kitty-specs/001-figma-to-code/tasks.md](kitty-specs/001-figma-to-code/tasks.md)*

# Work Packages: Figma-to-Code Rule Builder

**Inputs**: Design documents from `/kitty-specs/001-figma-to-code/`
**Prerequisites**: plan.md (required), spec.md (user stories), research.md (FigmaToCode analysis), data-model.md (Zustand stores), contracts/ (schemas)

**Architecture**: Multi-node library manager with 5 pages (Homepage Dashboard, Node Library, Viewer, Rule Manager, Settings)

**Organization**: Fine-grained subtasks (`Txxx`) roll up into work packages (`WPxx`). Each work package is independently deliverable and testable.

**Prompt Files**: Each work package references a matching prompt file in `tasks/planned/` generated by `/spec-kitty.tasks`. Treat this file as the high-level checklist; detailed implementation guidance lives in prompt files.

## Subtask Format: `[Txxx] [P?] Description`
- **[P]** indicates the subtask can proceed in parallel (different files/components).
- Include precise file paths or modules.

## Path Conventions
- **Next.js App Router**: `app/`, `components/`, `lib/`
- **Tests**: `__tests__/unit/`, `__tests__/integration/`, `__tests__/e2e/`

---

## Work Package WP01: Project Setup & Foundation (Priority: P0) ðŸŽ¯ MVP Foundation

**Goal**: Initialize Next.js 14+ project with TypeScript strict mode, install dependencies, configure tooling, and establish file structure for multi-node library manager.
**Independent Test**: Run `npm run dev`, navigate to http://localhost:3000, see placeholder Next.js page with no TypeScript errors.
**Prompt**: `tasks/planned/WP01-project-setup-and-foundation.md`

### Included Subtasks
- [ ] T001 Initialize Next.js 14+ project with App Router (`npx create-next-app@latest`)
- [ ] T002 Configure TypeScript strict mode in tsconfig.json (`strict: true`, `noImplicitAny: true`)
- [ ] T003 [P] Install core dependencies: React 18+, Next.js 14+, Zustand 4+, Monaco Editor, Tailwind CSS 3+
- [ ] T004 [P] Install and configure Shadcn/ui (`npx shadcn-ui@latest init`)
- [ ] T005 [P] Create project folder structure: `app/`, `components/`, `lib/`, `hooks/`, `__tests__/`
- [ ] T006 Create `figma-data/` directory structure (gitignored) and `mapping-rules.json` placeholder
- [ ] T007 Configure .gitignore (exclude `figma-data/`, `mapping-rules.json`, `.env.local`)
- [ ] T008 [P] Setup Vitest for unit tests with React Testing Library
- [ ] T009 [P] Setup Playwright for E2E tests
- [ ] T010 Create README.md with multi-node architecture overview
- [ ] T011 Verify build succeeds: `npm run build` with zero TypeScript errors

### Implementation Notes
- Use Next.js App Router (not Pages Router)
- Zustand chosen for state management (decision from planning)
- Monaco Editor dynamic import to reduce bundle size
- Feature-first testing strategy: implement features â†’ manual test â†’ write automated tests after

### Parallel Opportunities
- T003, T004, T008, T009 can run concurrently (different config files)

### Dependencies
- None (starting package).

### Risks & Mitigations
- **Dependency conflicts**: Pin exact versions in package.json (Next.js 14.x, React 18.x, Zustand 4.x)
- **Monaco bundle size**: Document dynamic import pattern for T003

---

## Work Package WP02: TypeScript Types & Contracts (Priority: P0) ðŸŽ¯ MVP Foundation

**Goal**: Define all TypeScript types matching data-model.md (8 entities, 3 Zustand stores) and integrate FigmaToCode improvements.
**Independent Test**: All type files compile with zero errors, can import types in test file, type guards validate runtime data.
**Prompt**: `tasks/planned/WP02-typescript-types-and-contracts.md`

### Included Subtasks
- [ ] T012 [P] Create `lib/types/figma.ts` with FigmaNode, Paint, Color, Effect, Rectangle, Constraints
- [ ] T013 [P] Add FigmaToCode enhanced properties to FigmaNode: `visible`, `rotation`, `opacity`, `blendMode`, `strokeTopWeight/Bottom/Left/Right`, `layoutSizingHorizontal/Vertical`, `layoutWrap`, `primaryAxisAlignItems`, `counterAxisAlignItems`, `exportSettings`
- [ ] T014 [P] Create `lib/types/altnode.ts` with AltNode, CSSProperties, `originalNode: FigmaNode` reference
- [ ] T015 [P] Add FigmaToCode metadata to AltNode: `uniqueName`, `canBeFlattened`, `svg`, `base64`, `cumulativeRotation`
- [ ] T016 [P] Create `lib/types/rule.ts` with MappingRule, Selector, Transformer, RuleMatch, RuleLibrary
- [ ] T017 [P] Create `lib/types/generated-code.ts` with GeneratedCode, CodeFormat, CodeMetadata
- [ ] T018 [P] Create `lib/types/library.ts` with NodeLibrary, NodeMetadata, LibraryIndex, DashboardStats
- [ ] T019 [P] Create `lib/types/store.ts` with NodesState, RulesState, UIState (Zustand store interfaces)
- [ ] T020 Create type guard functions in `lib/utils/validation.ts` (`isFigmaNode`, `isValidRule`, `isAltNode`)
- [ ] T021 Verify all types compile with TypeScript strict mode (`npm run type-check`)

### Implementation Notes
- Follow exact type definitions from data-model.md
- FigmaToCode enhancements from research.md Decision 7 (23 recommendations)
- Use discriminated unions for enums (`type FigmaNodeType = 'FRAME' | 'TEXT' | ...`)
- Type guards use `is` keyword for TypeScript narrowing

### Parallel Opportunities
- T012-T019 can all be created concurrently (no interdependencies)

### Dependencies
- Depends on WP01 (project structure exists).

### Risks & Mitigations
- **Type drift from Figma API**: Document Figma API version in comments (v1, 2025-11-23)

---

## Work Package WP03: Multi-Node Storage & Figma Client (Priority: P0) ðŸŽ¯ MVP - User Story 1

**Goal**: Implement Figma REST API integration with multi-node storage structure, library index management, and offline-first architecture.
**Independent Test**: Import 3 nodes, verify `figma-data/{nodeId}/` directories created, `library-index.json` updated, load library without API calls (offline mode).
**Prompt**: `tasks/planned/WP03-multi-node-storage-and-figma-client.md`

### Included Subtasks
- [ ] T022 Create `lib/figma-client.ts` with fetchNode(), fetchVariables(), fetchScreenshot()
- [ ] T023 Create `lib/utils/file-storage.ts` with multi-node functions: saveNodeData(), loadNodeData(), updateLibraryIndex()
- [ ] T024 Create `lib/utils/library-index.ts` with addNode(), removeNode(), searchNodes(), filterNodes(), sortNodes()
- [ ] T025 Create `lib/utils/url-parser.ts` to extract file_key and node_id from Figma URLs
- [ ] T026 Implement `app/api/figma/import/route.ts` (POST: fetch node, save to `figma-data/{nodeId}/`, update library index)
- [ ] T027 Implement `app/api/figma/refresh/route.ts` (POST: re-fetch specific node)
- [ ] T028 Implement `app/api/library/index/route.ts` (GET: load library-index.json)
- [ ] T029 Implement `app/api/library/stats/route.ts` (GET: calculate dashboard stats)
- [ ] T030 Add error handling for API failures (authentication, rate limits, network issues, invalid URLs)
- [ ] T031 Test multi-node storage: import nodes with different IDs, verify directory structure
- [ ] T032 Verify offline mode: Load library index, load cached nodes, no Figma API calls after initial import

### Implementation Notes
- Storage structure: `figma-data/{nodeId}/data.json`, `metadata.json`, `screenshot.png`
- Library index: `figma-data/library-index.json` tracks all nodes (name, type, import date, thumbnail path, coverage)
- Use `process.env.FIGMA_ACCESS_TOKEN` (server-side only, never client-side)
- Figma API endpoints: `GET /v1/files/{key}/nodes?ids={nodeId}`, `GET /images/{key}?ids={nodeId}`
- Constitution Principle III: Data Locality - fetch once, operate offline

### Parallel Opportunities
- T022-T025 (lib modules) can be developed concurrently
- T026-T029 (API routes) can be developed in parallel after T022-T025 complete

### Dependencies
- Depends on WP02 (FigmaNode, NodeMetadata, LibraryIndex types).

### Risks & Mitigations
- **Figma API rate limiting**: Implement exponential backoff, show user-friendly error with retry option
- **Large node trees (1000+ elements)**: Test with complex Figma components, monitor memory usage

---

## Work Package WP04: AltNode Transformation Engine (Priority: P0) ðŸŽ¯ MVP - User Story 1

**Goal**: Transform cached Figma JSON to normalized AltNode with FigmaToCode production patterns (invisible filtering, GROUP inlining, rotation, icon detection).
**Independent Test**: Load Figma JSON, transform to AltNode, verify: invisible nodes filtered, GROUP inlined, rotation converted to degrees, unique names generated.
**Prompt**: `tasks/planned/WP04-altnode-transformation-engine.md`

### Included Subtasks
- [ ] T033 Create `lib/altnode-transform.ts` with transformToAltNode() entry function
- [ ] T034 Implement FigmaToCode CRITICAL improvements:
  - Invisible node filtering (`if (visible === false) return null`)
  - GROUP node inlining (skip wrapper, process children with cumulative rotation)
  - Unique name generation with suffix counters (Button â†’ Button, Button_01, Button_02)
  - `originalNode: FigmaNode` reference preservation
- [ ] T035 [P] Implement normalizeLayout(): auto-layout â†’ flexbox (HORIZONTAL â†’ `display: flex, flexDirection: row`)
- [ ] T036 [P] Implement normalizeFills(): Figma fills â†’ CSS background
- [ ] T037 [P] Implement normalizeStrokes(): Figma strokes â†’ CSS border
- [ ] T038 [P] Implement normalizeEffects(): Figma effects â†’ CSS box-shadow
- [ ] T039 [P] Implement normalizeText(): text properties â†’ CSS font properties
- [ ] T040 Implement FigmaToCode HIGH priority improvements:
  - Rotation conversion: radians â†’ degrees (`-rotation * (180 / Math.PI)`)
  - Icon detection: `isLikelyIcon()` (type check, size â‰¤64px, export settings)
  - Empty container optimization (empty FRAME â†’ RECTANGLE)
  - Layout wrap support (`layoutWrap: "WRAP"` â†’ `flex-wrap`)
- [ ] T041 Test transformation with diverse Figma samples (horizontal/vertical layout, invisible nodes, nested GROUPs)
- [ ] T042 Verify performance: <50ms for 100-node tree

### Implementation Notes
- Follow FigmaToCode recommendations from research.md Decision 7 (5 CRITICAL + 12 HIGH priority)
- Recursive tree traversal with cumulative rotation tracking for GROUP children
- Handle null/undefined Figma properties gracefully (optional chaining)
- Preserve original Figma data in `altNode.originalNode` for complete access

### Parallel Opportunities
- T035-T039 (normalization functions) can be developed concurrently
- T040 improvements can be added incrementally after core transformation works

### Dependencies
- Depends on WP02 (AltNode types with FigmaToCode enhancements), WP03 (Figma data available).

### Risks & Mitigations
- **Figma edge cases**: 23 FigmaToCode recommendations cover most production edge cases, document remaining unknowns

---

## Work Package WP05: Rule Engine & Conflict Resolution (Priority: P0) ðŸŽ¯ MVP - User Story 5

**Goal**: Implement rule matching with AND-logic selectors, priority-based conflict resolution, and property provenance tracking.
**Independent Test**: Create 3 rules with overlapping selectors and conflicts, evaluate against AltNode tree, verify priority resolution and property composition.
**Prompt**: `tasks/planned/WP05-rule-engine-and-conflict-resolution.md`

### Included Subtasks
- [ ] T043 Create `lib/rule-engine.ts` with evaluateRules(altNode, rules) function
- [ ] T044 Implement selectorMatches(altNode, selector): AND-logic pattern matching (all selector properties must match)
- [ ] T045 Implement resolveConflicts(matches): priority-based property composition (higher priority wins on conflicts)
- [ ] T046 Add conflict detection: minor (yellow) vs major (red) conflicts
- [ ] T047 Track property provenance: record which rule contributed each CSS property
- [ ] T048 Test rule matching: multiple rules, overlapping selectors, priority override
- [ ] T049 Benchmark performance: <2 seconds for 50 rules Ã— 100 nodes (Success Criteria SC-005)

### Implementation Notes
- Selector matching: ALL properties must match (AND logic, not OR)
- Priority sorting: Descending order (highest priority first)
- Conflict resolution: Property-level composition (not rule-level override)
- RuleMatch structure: `{ ruleId, priority, contributedProperties, conflicts }`
- Constitution Principle VI: Simple Before Clever - property matching sufficient, no CSS selector parser needed

### Parallel Opportunities
- T044-T047 can be developed in parallel if function signatures agreed upfront

### Dependencies
- Depends on WP02 (MappingRule, RuleMatch types), WP04 (AltNode available).

### Risks & Mitigations
- **Performance at scale**: Profile with realistic workloads (50 rules Ã— 100 nodes), optimize if >2s

---

## Work Package WP06: Code Generators (Priority: P0) ðŸŽ¯ MVP - User Story 4

**Goal**: Generate React JSX, React+Tailwind, HTML/CSS from AltNode + resolved rules with FigmaToCode Tailwind mappings.
**Independent Test**: Pass AltNode with resolved properties, verify generated code is syntactically valid, uses arbitrary Tailwind values when needed, handles rotation classes.
**Prompt**: `tasks/planned/WP06-code-generators.md`

### Included Subtasks
- [ ] T050 [P] Create `lib/code-generators/react.ts` for React JSX with inline styles
- [ ] T051 [P] Create `lib/code-generators/react-tailwind.ts` for React with Tailwind utility classes
- [ ] T052 [P] Create `lib/code-generators/html-css.ts` for HTML + separate CSS file
- [ ] T053 Create `lib/code-generators/helpers.ts` with toPascalCase(), cssObjectToString(), formatCode()
- [ ] T054 Implement FigmaToCode Tailwind enhancements in react-tailwind.ts:
  - Arbitrary value fallbacks (`gap-[13px]` when no standard class)
  - Rotation classes (`rotate-45`, `rotate-[47deg]`)
  - Opacity conversion (0-1 â†’ Tailwind scale: 0, 25, 50, 75, 100)
  - PascalCase validation (prefix numeric-leading names with "Component")
- [ ] T055 Add syntax highlighting preparation: integrate Prism.js or Shiki
- [ ] T056 Test generated code validity: React JSX â†’ JSX parser, HTML â†’ DOM parser
- [ ] T057 Verify code readability: proper indentation, line breaks, component naming

### Implementation Notes
- Template-based generation (string interpolation, not AST manipulation)
- React JSX: Export function components with inline styles as `React.CSSProperties`
- React+Tailwind: Map CSS properties to Tailwind classes, use arbitrary values for non-standard values
- HTML/CSS: Generate separate `.css` file with class selectors
- Recursive generation for nested children
- FigmaToCode recommendations: TODO comments for MEDIUM priority enhancements (context-aware sizing, hex-to-Tailwind colors, shadow matching)

### Parallel Opportunities
- T050-T052 (generators) can be developed concurrently (independent modules)

### Dependencies
- Depends on WP02 (GeneratedCode types), WP05 (resolved properties available).

### Risks & Mitigations
- **Tailwind mapping completeness**: Focus on common properties first, add edge cases incrementally

---

## Work Package WP07: Zustand State Management (Priority: P0) ðŸŽ¯ MVP Foundation

**Goal**: Implement 3 Zustand stores (nodes-store, rules-store, ui-store) with actions for multi-node library management.
**Independent Test**: Load library, import node (state updates), select node (state updates), verify Zustand DevTools shows state changes.
**Prompt**: `tasks/planned/WP07-zustand-state-management.md`

### Included Subtasks
- [ ] T058 Create `lib/store/nodes-store.ts` with NodesState: nodes[], selectedNodeId, viewMode, searchTerm, filters, sort
- [ ] T059 Add nodes-store actions: loadLibrary(), importNode(), deleteNode(), selectNode(), setViewMode(), setSearchTerm(), setFilters(), setSortCriteria()
- [ ] T060 Create `lib/store/rules-store.ts` with RulesState: rules[], selectedRuleId, ruleMatches (Map)
- [ ] T061 Add rules-store actions: loadRules(), saveRules(), createRule(), updateRule(), deleteRule(), duplicateRule(), importRules(), exportRules(), evaluateRules()
- [ ] T062 Create `lib/store/ui-store.ts` with UIState: theme, isImporting, isLoadingRules, stats (DashboardStats), statsLastUpdated
- [ ] T063 Add ui-store actions: setTheme(), setImporting(), loadStats(), invalidateStats()
- [ ] T064 Create `lib/store/index.ts` to combine stores and export hooks
- [ ] T065 Setup Zustand DevTools integration for debugging
- [ ] T066 Test state updates: import node â†’ nodes array grows, create rule â†’ rules array updates, verify persistence across page navigation

### Implementation Notes
- Zustand chosen over Context API for DevTools support and performance at scale (100+ nodes)
- State persisted in localStorage for UI preferences (theme, viewMode, filters)
- Rules and nodes loaded from filesystem via API routes (not localStorage)
- DashboardStats cached with 5-minute TTL to avoid recalculating on every render

### Parallel Opportunities
- T058-T063 (3 stores) can be developed concurrently, then integrated in T064

### Dependencies
- Depends on WP02 (store types), WP03 (API routes for library/rules), WP05 (rule evaluation).

### Risks & Mitigations
- **State complexity**: Keep stores focused (nodes, rules, UI), avoid cross-store dependencies

---

## Work Package WP08: Homepage Dashboard (Priority: P1) ðŸŽ¯ MVP - User Story 3

**Goal**: Build Homepage (`app/page.tsx`) with dashboard stats, recent nodes, rule usage chart, and import field.
**Independent Test**: Visit `/`, verify stats cards show correct counts, recent nodes section displays 5 most recent with thumbnails, import field accepts Figma URL.
**Prompt**: `tasks/planned/WP08-homepage-dashboard.md`

### Included Subtasks
- [ ] T067 Create `app/page.tsx` with dashboard layout (stats cards, recent nodes, import field, quick actions)
- [ ] T068 Create `components/stats-card.tsx` for dashboard metrics (total nodes, total rules, avg coverage, last import)
- [ ] T069 Create `components/recent-nodes.tsx` displaying 5 most recent imports with thumbnails
- [ ] T070 Create `components/rule-usage-chart.tsx` showing top 5 most-matched rules (bar chart)
- [ ] T071 Create `components/import-dialog.tsx` with URL input, auto-parsing, import flow
- [ ] T072 Create `hooks/use-library-stats.ts` to calculate dashboard stats (calls `/api/library/stats`)
- [ ] T073 Implement import flow: paste URL â†’ parse file_key/node_id â†’ call `/api/figma/import` â†’ update library
- [ ] T074 Add quick action buttons: "View All Nodes" â†’ `/nodes`, "Manage Rules" â†’ `/rules`
- [ ] T075 Test complete homepage flow: stats load, import node, stats update, recent nodes show new import

### Implementation Notes
- Dashboard stats from `hooks/use-library-stats.ts` (wraps Zustand ui-store.loadStats())
- Import dialog reuses URL parser from WP03 (lib/utils/url-parser.ts)
- Chart library: Recharts or Chart.js for rule usage visualization
- Success Criteria SC-012: Stats accurate and update within 1 second of changes

### Parallel Opportunities
- T068-T071 (components) can be developed concurrently

### Dependencies
- Depends on WP03 (import API, library stats API), WP07 (Zustand stores), WP01 (Shadcn/ui).

### Risks & Mitigations
- **Stats calculation performance**: Cache in ui-store with 5-minute TTL, recalculate only on node/rule changes

---

## Work Package WP09: Node Library Page (Priority: P0) ðŸŽ¯ MVP - User Story 2

**Goal**: Build Node Library page (`app/nodes/page.tsx`) with grid/list view, search, filter, sort, bulk actions.
**Independent Test**: Navigate to `/nodes`, see all imported nodes, toggle grid/list view, search by name, filter by type, select multiple nodes and delete.
**Prompt**: `tasks/planned/WP09-node-library-page.md`

### Included Subtasks
- [ ] T076 Create `app/nodes/page.tsx` with library grid layout
- [ ] T077 Create `components/node-card.tsx` for grid view (thumbnail, name, type, date, coverage badge)
- [ ] T078 Implement grid/list view toggle (updates Zustand nodes-store.viewMode)
- [ ] T079 Create search input with real-time filtering (updates nodes-store.searchTerm)
- [ ] T080 Create filter dropdown by node type (FRAME, TEXT, GROUP, COMPONENT) and coverage
- [ ] T081 Create sort dropdown (name, date, type, coverage) with asc/desc order
- [ ] T082 Implement bulk selection: checkboxes on cards, "Delete Selected" button
- [ ] T083 Add individual node actions: view (â†’ `/viewer/{nodeId}`), rename, export, re-fetch, delete
- [ ] T084 Test library management: import 10 nodes, search, filter, sort, bulk delete 3 nodes
- [ ] T085 Verify Success Criteria SC-002: Find specific node via search within 3 seconds (50 nodes)
- [ ] T086 Verify Success Criteria SC-003: Toggle view/filter/sort within 1 second (instant UI response)

### Implementation Notes
- Library data from Zustand nodes-store (loads from `/api/library/index`)
- Grid view: Shadcn/ui Card components in CSS grid
- List view: Shadcn/ui Table component with sortable columns
- Search/filter/sort: Client-side operations on nodes-store.nodes array
- Bulk actions: Track selected node IDs in component state, call nodes-store.deleteNode() for each

### Parallel Opportunities
- T077-T083 (components and features) can be developed iteratively

### Dependencies
- Depends on WP03 (library index), WP07 (nodes-store), WP01 (Shadcn/ui).

### Risks & Mitigations
- **Performance with 100+ nodes**: Use virtualized grid (react-window) if rendering >100 cards causes lag

---

## Work Package WP10: Viewer Page (Priority: P1) ðŸŽ¯ MVP - User Story 4

**Goal**: Build Viewer page (`app/viewer/[nodeId]/page.tsx`) with 2 tabs: Code (Figma tree + Applied Rules Inspector) and Render (preview with format switcher).
**Independent Test**: Navigate to `/viewer/{nodeId}`, see Code tab with tree and rules inspector, switch to Render tab, change format (React JSX/Tailwind/HTML), preview updates.
**Prompt**: `tasks/planned/WP10-viewer-page.md`

### Included Subtasks
- [ ] T087 Create `app/viewer/[nodeId]/page.tsx` with tabs layout (Code, Render)
- [ ] T088 Create header: node thumbnail (expandable), name, prev/next navigation, re-fetch, export dropdown, "Edit Rules" button
- [ ] T089 Create breadcrumbs: Home > Library > NodeName
- [ ] T090 Create `components/figma-tree-view.tsx` for hierarchical AltNode tree display (Code tab left panel)
- [ ] T091 Create `components/applied-rules-inspector.tsx` for selected node (Code tab right panel):
  - Matched rules ordered by priority
  - Priority resolution (which rule wins per property)
  - Conflicts highlighted (yellow minor, red major)
  - Coverage stats (X/Y nodes have rules, Z% coverage)
  - Unused rules warning
- [ ] T092 Implement tree node click handler: update Applied Rules Inspector
- [ ] T093 Create `components/preview-tabs.tsx` for Render tab with format switcher (React JSX, React+Tailwind, HTML/CSS)
- [ ] T094 Create `components/code-preview.tsx` with syntax highlighting (Prism.js or Shiki)
- [ ] T095 Wire code generators: call react.ts, react-tailwind.ts, html-css.ts based on selected format
- [ ] T096 Add export dropdown: copy-to-clipboard, download code file
- [ ] T097 Test Viewer flow: click node in library â†’ Viewer opens, click tree node â†’ inspector updates, switch formats â†’ preview re-renders
- [ ] T098 Verify Success Criteria SC-006: Tree click â†’ Applied Rules Inspector update within 200ms
- [ ] T099 Verify Success Criteria SC-007: Format switch â†’ preview update within 500ms

### Implementation Notes
- Dynamic route: `app/viewer/[nodeId]/page.tsx` receives nodeId from params
- Load node data from Zustand nodes-store or API if not cached
- Code tab: ResizablePanels with tree (left) and inspector (right)
- Render tab: Full-width iframe with generated code, format selector in header
- Applied Rules Inspector: Evaluate rules for clicked node, display RuleMatch[] with provenance
- Success Criteria SC-008: Inspector clarity allows understanding conflicts without external docs

### Parallel Opportunities
- T090-T091 (Code tab components) and T093-T095 (Render tab components) can be developed in parallel

### Dependencies
- Depends on WP05 (rule engine), WP06 (code generators), WP07 (stores), WP04 (AltNode).

### Risks & Mitigations
- **Deep tree navigation performance**: Use React.memo for tree nodes, virtualize if >500 nodes

---

## Work Package WP11: Rule Manager Page (Priority: P0) ðŸŽ¯ MVP - User Story 5

**Goal**: Build Rule Manager page (`app/rules/page.tsx`) with searchable rule list sidebar, Monaco editor modal, import/export, and match count badges.
**Independent Test**: Navigate to `/rules`, see rule list with match counts, click "New Rule" â†’ Monaco opens, edit JSON, save, verify rule appears in sidebar with updated match count.
**Prompt**: `tasks/planned/WP11-rule-manager-page.md`

### Included Subtasks
- [ ] T100 Create `app/rules/page.tsx` with sidebar + main panel layout
- [ ] T101 Create rule list sidebar: searchable, shows name, priority, match count badge, unused warning (0 matches)
- [ ] T102 Create main panel: selected rule details (ID, name, priority editable, selector/transformer preview, match count, actions)
- [ ] T103 Create `components/rule-editor.tsx` wrapping Monaco Editor with JSON schema validation
- [ ] T104 Configure Monaco with contracts/rule-schema.json for real-time validation and autocomplete
- [ ] T105 Implement "New Rule" button: open Monaco with template rule JSON
- [ ] T106 Implement "Edit JSON" button: open Monaco with selected rule, save updates to rules-store
- [ ] T107 Implement "Duplicate" action: create new rule with same selector/transformer, new ID, incremented priority
- [ ] T108 Implement "Delete" action: confirmation dialog, remove from rules-store
- [ ] T109 Add top actions: "Import Rules" (upload JSON file, merge with conflict resolution), "Export Rules" (download mapping-rules.json)
- [ ] T110 Create `hooks/use-rule-matches.ts` to calculate match counts across all nodes in library
- [ ] T111 Test Rule Manager flow: create rule, edit, duplicate, delete, import rules file, export rules
- [ ] T112 Verify Success Criteria SC-005: Create rule â†’ match counts update across all nodes within 2 seconds
- [ ] T113 Verify Success Criteria SC-009: Export rule library â†’ re-import in fresh project â†’ no data loss

### Implementation Notes
- Sidebar: List of rules from Zustand rules-store, search filters by name/ID
- Match count badges: Run rule engine against all nodes in library (use-rule-matches.ts hook)
- Monaco Editor: Dynamic import to reduce bundle size, JSON language server with schema validation
- Import rules: Validate against schema, merge into existing rules, show conflict dialog if duplicate IDs
- Export rules: Download complete mapping-rules.json with version metadata
- Success Criteria SC-014: Match counts 100% accurate across all nodes

### Parallel Opportunities
- T101-T102 (UI layout) and T103-T104 (Monaco setup) can be developed in parallel

### Dependencies
- Depends on WP07 (rules-store), WP05 (rule engine for match counts), WP01 (Monaco installed), contracts/rule-schema.json.

### Risks & Mitigations
- **Match count calculation performance**: Debounce recalculation, run in background, show loading spinner if >2 seconds

---

## Work Package WP12: Settings Page (Priority: P2) ðŸŽ¯ MVP - User Story 6

**Goal**: Build Settings page (`app/settings/page.tsx`) with 5 sections: Figma API, Export Preferences, Rule Editor, Cache Management, Appearance.
**Independent Test**: Navigate to `/settings`, enter Figma token, test connection, change theme, verify UI updates immediately.
**Prompt**: `tasks/planned/WP12-settings-page.md`

### Included Subtasks
- [ ] T114 Create `app/settings/page.tsx` with 5 sections layout
- [ ] T115 Create Figma API section: masked token input with show/hide toggle, "Test Connection" button, API base URL input
- [ ] T116 Implement "Test Connection": call Figma API `/v1/me`, show success/failure toast
- [ ] T117 Create Export Preferences section: default framework dropdown (React JSX, React+Tailwind, HTML/CSS), language dropdown (TypeScript, JavaScript), formatting toggles
- [ ] T118 Create Rule Editor section: auto-save toggle, default priority input for new rules
- [ ] T119 Create Cache Management section: display cache size, node count, "Clear All Cache" button, "Re-fetch All Nodes" button
- [ ] T120 Implement "Clear All Cache": confirmation dialog, delete all `figma-data/` files, reset library index
- [ ] T121 Create Appearance section: theme selector (Light, Dark, System)
- [ ] T122 Implement theme switching: update Zustand ui-store.theme, apply to entire app via Context Provider
- [ ] T123 Test Settings flow: change token, test connection, change theme, clear cache, verify settings persist across sessions

### Implementation Notes
- Settings stored in localStorage (UI preferences) and .env.local (Figma token)
- Theme: Use Next.js next-themes provider with Shadcn/ui theming
- Cache management: Call API route to delete figma-data/ directory, update library index
- Auto-save: Store in localStorage, apply in Monaco Editor component (WP11)
- Success Criteria SC-013: App operates offline after initial imports (verified by disabling network, navigating pages)

### Parallel Opportunities
- T115-T121 (5 sections) can be developed concurrently

### Dependencies
- Depends on WP07 (ui-store for theme), WP03 (Figma client for test connection), WP01 (Shadcn/ui).

### Risks & Mitigations
- **Token security**: Remind users to gitignore .env.local, document secure token storage practices

---

## Work Package WP13: Global Navigation & Layout (Priority: P0) ðŸŽ¯ MVP Foundation

**Goal**: Implement top navigation bar, page routing, breadcrumbs, and state preservation across navigation.
**Independent Test**: Navigate between all 5 pages (/, /nodes, /viewer/{id}, /rules, /settings), verify top nav always visible, breadcrumbs update, state preserved (selected filters, search terms).
**Prompt**: `tasks/planned/WP13-global-navigation-and-layout.md`

### Included Subtasks
- [ ] T124 Create `app/layout.tsx` with top navigation bar (Logo | Home | Library | Rules | Settings)
- [ ] T125 Create `components/navigation.tsx` with active page highlighting
- [ ] T126 Implement routing with Next.js Link components
- [ ] T127 Add breadcrumbs component for Viewer page (Home > Library > NodeName)
- [ ] T128 Setup Zustand state persistence for navigation (selected node, filters, search terms)
- [ ] T129 Implement browser back/forward navigation: restore page state correctly
- [ ] T130 Test navigation flow: Homepage â†’ Library â†’ Viewer â†’ Rules â†’ Settings â†’ back/forward, verify state preserved
- [ ] T131 Verify Success Criteria SC-004: Navigate between pages, return to previous state without data loss

### Implementation Notes
- Top nav: Shadcn/ui NavigationMenu component, always visible on all pages
- Active page: Use Next.js usePathname() hook to highlight current page
- State preservation: Zustand stores persist in memory during session, localStorage for UI preferences
- Browser navigation: Next.js App Router handles history automatically, Zustand state remains in memory
- Constitution Principle IX: Separation of Pages - distinct pages for viewing, editing, management

### Parallel Opportunities
- T124-T127 (navigation components) can be developed in parallel with T128-T129 (state management)

### Dependencies
- Depends on WP07 (Zustand stores), WP08-WP12 (all pages exist).

### Risks & Mitigations
- **State loss on refresh**: Document that page refresh clears Zustand state (expected behavior), data reloads from filesystem

---

## Work Package WP14: Testing & Validation (Priority: P3)

**Goal**: Write comprehensive tests (unit, integration, E2E) to lock down behavior and validate all 15 Success Criteria.
**Independent Test**: Run `npm test`, verify all tests pass. Run E2E suite, verify complete workflows (import â†’ rule â†’ export) succeed.
**Prompt**: `tasks/planned/WP14-testing-and-validation.md`

### Included Subtasks
- [ ] T132 [P] Write unit tests for rule-engine.ts (90% coverage target - Constitution requirement)
- [ ] T133 [P] Write unit tests for altnode-transform.ts (80% coverage target):
  - Invisible node filtering
  - GROUP node inlining
  - Rotation conversion
  - Icon detection
  - Empty container optimization
- [ ] T134 [P] Write unit tests for code-generators/ (70% coverage target):
  - React JSX generation
  - React+Tailwind with arbitrary values
  - HTML/CSS separation
  - Rotation classes
  - Opacity conversion
- [ ] T135 [P] Write unit tests for file-storage.ts, library-index.ts (70% coverage)
- [ ] T136 Write integration tests for multi-node import flow (fetch â†’ transform â†’ save â†’ index update)
- [ ] T137 Write integration tests for rule creation flow (create â†’ evaluate â†’ match counts update)
- [ ] T138 Write component tests for key React components:
  - rule-editor.tsx (Monaco integration)
  - figma-tree-view.tsx (recursive rendering)
  - applied-rules-inspector.tsx (match display)
- [ ] T139 Write E2E tests for complete workflows (Playwright):
  - Import node â†’ view dashboard â†’ navigate to library â†’ view node
  - Create rule â†’ edit in Monaco â†’ save â†’ verify match counts
  - View node â†’ inspect tree â†’ see Applied Rules â†’ export code
- [ ] T140 Validate all 15 Success Criteria (SC-001 to SC-015) with explicit tests
- [ ] T141 Run full test suite: verify 90% rule engine, 80% transformations, 70% other modules
- [ ] T142 Performance tests: measure import time, rule evaluation time, preview update time

### Implementation Notes
- Feature-first testing strategy: Tests written AFTER features implemented (planning decision)
- Coverage targets from Constitution Testing Standards
- E2E tests validate user stories end-to-end
- Success Criteria validation:
  - SC-001: Import within 10s
  - SC-002: Search within 3s (50 nodes)
  - SC-003: UI interactions <1s
  - SC-005: Rule creation â†’ match counts <2s
  - SC-006: Tree click â†’ inspector <200ms
  - SC-007: Format switch â†’ preview <500ms
  - SC-012: Stats update <1s
  - SC-013: Offline mode after initial imports

### Parallel Opportunities
- T132-T135 (unit tests) can all be written concurrently
- T136-T138 (integration/component tests) can be written in parallel
- T139 (E2E tests) can be written while other tests are in progress

### Dependencies
- Depends on all previous work packages (tests validate complete application).

### Risks & Mitigations
- **Test maintenance burden**: Focus on critical paths (rule engine, transformation, import flow), document test patterns

---

## Dependency & Execution Summary

**Sequence**:
1. **WP01** (Setup) â†’ **WP02** (Types with FigmaToCode enhancements)
2. **WP03** (Multi-Node Storage), **WP04** (AltNode Transform), **WP05** (Rule Engine) start after WP02
3. **WP06** (Code Generators) starts after WP05 (needs resolved properties)
4. **WP07** (Zustand Stores) starts after WP03, WP05 (needs library API + rule evaluation)
5. **WP08** (Homepage), **WP09** (Library Page), **WP10** (Viewer), **WP11** (Rule Manager), **WP12** (Settings) start after WP07 (need state management)
6. **WP13** (Navigation) starts after WP08-WP12 (all pages exist)
7. **WP14** (Testing) runs after all features complete

**Parallelization**:
- WP03, WP04, WP05 can run concurrently after WP02
- WP08, WP09, WP10, WP11, WP12 can run concurrently after WP07
- Within each work package, subtasks marked `[P]` are parallel-safe

**MVP Scope** (Covers User Stories 1-5, P0+P1):
- Foundation: WP01, WP02, WP07, WP13 (setup, types, state, navigation)
- Core Engine: WP03, WP04, WP05, WP06 (storage, transform, rules, codegen)
- Pages (P0+P1): WP08 (Homepage/Dashboard), WP09 (Library), WP10 (Viewer), WP11 (Rule Manager)
- Optional for MVP: WP12 (Settings - P2), WP14 (Testing - polish)

**Critical Path**: WP01 â†’ WP02 â†’ WP04 â†’ WP05 â†’ WP06 â†’ WP07 â†’ WP10 (longest dependency chain for Viewer functionality)

---

## Subtask Index (Reference)

| Subtask ID | Summary | Work Package | Priority | Parallel? | File Path |
|------------|---------|--------------|----------|-----------|-----------|
| T001 | Init Next.js 14+ | WP01 | P0 | No | Root |
| T002 | Config TS strict | WP01 | P0 | No | tsconfig.json |
| T003 | Install dependencies | WP01 | P0 | Yes | package.json |
| T004 | Setup Shadcn/ui | WP01 | P0 | Yes | Shadcn config |
| T005 | Create folder structure | WP01 | P0 | Yes | app/, components/, lib/ |
| T006 | Create figma-data/ structure | WP01 | P0 | No | figma-data/ |
| T007 | Config .gitignore | WP01 | P0 | No | .gitignore |
| T008 | Setup Vitest | WP01 | P0 | Yes | vitest.config.ts |
| T009 | Setup Playwright | WP01 | P0 | Yes | playwright.config.ts |
| T010 | Create README | WP01 | P0 | Yes | README.md |
| T011 | Verify build | WP01 | P0 | No | Build check |
| T012 | Create figma.ts types | WP02 | P0 | Yes | lib/types/figma.ts |
| T013 | Add FigmaToCode Figma props | WP02 | P0 | Yes | lib/types/figma.ts |
| T014 | Create altnode.ts types | WP02 | P0 | Yes | lib/types/altnode.ts |
| T015 | Add FigmaToCode AltNode props | WP02 | P0 | Yes | lib/types/altnode.ts |
| T016 | Create rule.ts types | WP02 | P0 | Yes | lib/types/rule.ts |
| T017 | Create generated-code.ts | WP02 | P0 | Yes | lib/types/generated-code.ts |
| T018 | Create library.ts types | WP02 | P0 | Yes | lib/types/library.ts |
| T019 | Create store.ts types | WP02 | P0 | Yes | lib/types/store.ts |
| T020 | Create type guards | WP02 | P0 | No | lib/utils/validation.ts |
| T021 | Verify types compile | WP02 | P0 | No | Type check |
| T022 | Create figma-client.ts | WP03 | P0 | No | lib/figma-client.ts |
| T023 | Create file-storage.ts | WP03 | P0 | Yes | lib/utils/file-storage.ts |
| T024 | Create library-index.ts | WP03 | P0 | Yes | lib/utils/library-index.ts |
| T025 | Create url-parser.ts | WP03 | P0 | Yes | lib/utils/url-parser.ts |
| T026 | API route: import | WP03 | P0 | No | app/api/figma/import/route.ts |
| T027 | API route: refresh | WP03 | P0 | Yes | app/api/figma/refresh/route.ts |
| T028 | API route: library index | WP03 | P0 | Yes | app/api/library/index/route.ts |
| T029 | API route: stats | WP03 | P0 | Yes | app/api/library/stats/route.ts |
| T030 | Error handling | WP03 | P0 | No | lib/figma-client.ts |
| T031 | Test multi-node storage | WP03 | P0 | No | Integration test |
| T032 | Verify offline mode | WP03 | P0 | No | Integration test |
| T033 | Create altnode-transform.ts | WP04 | P0 | No | lib/altnode-transform.ts |
| T034 | FigmaToCode CRITICAL fixes | WP04 | P0 | No | lib/altnode-transform.ts |
| T035 | normalizeLayout() | WP04 | P0 | Yes | lib/altnode-transform.ts |
| T036 | normalizeFills() | WP04 | P0 | Yes | lib/altnode-transform.ts |
| T037 | normalizeStrokes() | WP04 | P0 | Yes | lib/altnode-transform.ts |
| T038 | normalizeEffects() | WP04 | P0 | Yes | lib/altnode-transform.ts |
| T039 | normalizeText() | WP04 | P0 | Yes | lib/altnode-transform.ts |
| T040 | FigmaToCode HIGH improvements | WP04 | P0 | No | lib/altnode-transform.ts |
| T041 | Test transformation | WP04 | P0 | No | __tests__/unit/altnode-transform.test.ts |
| T042 | Verify performance | WP04 | P0 | No | Benchmark |
| T043 | Create rule-engine.ts | WP05 | P0 | No | lib/rule-engine.ts |
| T044 | selectorMatches() | WP05 | P0 | Yes | lib/rule-engine.ts |
| T045 | resolveConflicts() | WP05 | P0 | Yes | lib/rule-engine.ts |
| T046 | Conflict detection | WP05 | P0 | Yes | lib/rule-engine.ts |
| T047 | Property provenance | WP05 | P0 | No | lib/rule-engine.ts |
| T048 | Test rule matching | WP05 | P0 | No | __tests__/unit/rule-engine.test.ts |
| T049 | Benchmark performance | WP05 | P0 | No | Benchmark |
| T050 | Generator: react.ts | WP06 | P0 | Yes | lib/code-generators/react.ts |
| T051 | Generator: react-tailwind.ts | WP06 | P0 | Yes | lib/code-generators/react-tailwind.ts |
| T052 | Generator: html-css.ts | WP06 | P0 | Yes | lib/code-generators/html-css.ts |
| T053 | Helper functions | WP06 | P0 | No | lib/code-generators/helpers.ts |
| T054 | FigmaToCode Tailwind enhancements | WP06 | P0 | No | lib/code-generators/react-tailwind.ts |
| T055 | Syntax highlighting prep | WP06 | P0 | No | Prism.js/Shiki |
| T056 | Test generated code | WP06 | P0 | No | __tests__/unit/code-generators.test.ts |
| T057 | Verify code readability | WP06 | P0 | No | Manual inspection |
| T058 | Create nodes-store.ts | WP07 | P0 | Yes | lib/store/nodes-store.ts |
| T059 | nodes-store actions | WP07 | P0 | No | lib/store/nodes-store.ts |
| T060 | Create rules-store.ts | WP07 | P0 | Yes | lib/store/rules-store.ts |
| T061 | rules-store actions | WP07 | P0 | No | lib/store/rules-store.ts |
| T062 | Create ui-store.ts | WP07 | P0 | Yes | lib/store/ui-store.ts |
| T063 | ui-store actions | WP07 | P0 | No | lib/store/ui-store.ts |
| T064 | Combine stores | WP07 | P0 | No | lib/store/index.ts |
| T065 | Zustand DevTools | WP07 | P0 | No | lib/store/index.ts |
| T066 | Test state updates | WP07 | P0 | No | Integration test |
| T067 | Create app/page.tsx dashboard | WP08 | P1 | No | app/page.tsx |
| T068 | Create stats-card.tsx | WP08 | P1 | Yes | components/stats-card.tsx |
| T069 | Create recent-nodes.tsx | WP08 | P1 | Yes | components/recent-nodes.tsx |
| T070 | Create rule-usage-chart.tsx | WP08 | P1 | Yes | components/rule-usage-chart.tsx |
| T071 | Create import-dialog.tsx | WP08 | P1 | Yes | components/import-dialog.tsx |
| T072 | Create use-library-stats.ts | WP08 | P1 | No | hooks/use-library-stats.ts |
| T073 | Implement import flow | WP08 | P1 | No | app/page.tsx |
| T074 | Quick action buttons | WP08 | P1 | Yes | app/page.tsx |
| T075 | Test homepage flow | WP08 | P1 | No | E2E test |
| T076 | Create app/nodes/page.tsx | WP09 | P0 | No | app/nodes/page.tsx |
| T077 | Create node-card.tsx | WP09 | P0 | Yes | components/node-card.tsx |
| T078 | Grid/list toggle | WP09 | P0 | No | app/nodes/page.tsx |
| T079 | Search input | WP09 | P0 | Yes | app/nodes/page.tsx |
| T080 | Filter dropdown | WP09 | P0 | Yes | app/nodes/page.tsx |
| T081 | Sort dropdown | WP09 | P0 | Yes | app/nodes/page.tsx |
| T082 | Bulk selection | WP09 | P0 | No | app/nodes/page.tsx |
| T083 | Node actions | WP09 | P0 | Yes | components/node-card.tsx |
| T084 | Test library management | WP09 | P0 | No | E2E test |
| T085 | Verify SC-002 (search 3s) | WP09 | P0 | No | Performance test |
| T086 | Verify SC-003 (UI 1s) | WP09 | P0 | No | Performance test |
| T087 | Create app/viewer/[nodeId] | WP10 | P1 | No | app/viewer/[nodeId]/page.tsx |
| T088 | Header with nav/actions | WP10 | P1 | Yes | app/viewer/[nodeId]/page.tsx |
| T089 | Breadcrumbs | WP10 | P1 | Yes | app/viewer/[nodeId]/page.tsx |
| T090 | Create figma-tree-view.tsx | WP10 | P1 | Yes | components/figma-tree-view.tsx |
| T091 | Create applied-rules-inspector | WP10 | P1 | Yes | components/applied-rules-inspector.tsx |
| T092 | Tree click handler | WP10 | P1 | No | components/figma-tree-view.tsx |
| T093 | Create preview-tabs.tsx | WP10 | P1 | Yes | components/preview-tabs.tsx |
| T094 | Create code-preview.tsx | WP10 | P1 | Yes | components/code-preview.tsx |
| T095 | Wire code generators | WP10 | P1 | No | components/preview-tabs.tsx |
| T096 | Export dropdown | WP10 | P1 | Yes | app/viewer/[nodeId]/page.tsx |
| T097 | Test Viewer flow | WP10 | P1 | No | E2E test |
| T098 | Verify SC-006 (inspector 200ms) | WP10 | P1 | No | Performance test |
| T099 | Verify SC-007 (preview 500ms) | WP10 | P1 | No | Performance test |
| T100 | Create app/rules/page.tsx | WP11 | P0 | No | app/rules/page.tsx |
| T101 | Rule list sidebar | WP11 | P0 | Yes | app/rules/page.tsx |
| T102 | Main panel details | WP11 | P0 | Yes | app/rules/page.tsx |
| T103 | Create rule-editor.tsx Monaco | WP11 | P0 | No | components/rule-editor.tsx |
| T104 | Monaco JSON schema config | WP11 | P0 | No | components/rule-editor.tsx |
| T105 | "New Rule" button | WP11 | P0 | No | app/rules/page.tsx |
| T106 | "Edit JSON" button | WP11 | P0 | No | app/rules/page.tsx |
| T107 | "Duplicate" action | WP11 | P0 | Yes | app/rules/page.tsx |
| T108 | "Delete" action | WP11 | P0 | Yes | app/rules/page.tsx |
| T109 | Import/Export buttons | WP11 | P0 | Yes | app/rules/page.tsx |
| T110 | Create use-rule-matches.ts | WP11 | P0 | No | hooks/use-rule-matches.ts |
| T111 | Test Rule Manager flow | WP11 | P0 | No | E2E test |
| T112 | Verify SC-005 (rule create 2s) | WP11 | P0 | No | Performance test |
| T113 | Verify SC-009 (export/import) | WP11 | P0 | No | Integration test |
| T114 | Create app/settings/page.tsx | WP12 | P2 | No | app/settings/page.tsx |
| T115 | Figma API section | WP12 | P2 | Yes | app/settings/page.tsx |
| T116 | Test Connection button | WP12 | P2 | No | app/settings/page.tsx |
| T117 | Export Preferences section | WP12 | P2 | Yes | app/settings/page.tsx |
| T118 | Rule Editor section | WP12 | P2 | Yes | app/settings/page.tsx |
| T119 | Cache Management section | WP12 | P2 | Yes | app/settings/page.tsx |
| T120 | Clear Cache button | WP12 | P2 | No | app/settings/page.tsx |
| T121 | Appearance section | WP12 | P2 | Yes | app/settings/page.tsx |
| T122 | Theme switching | WP12 | P2 | No | app/settings/page.tsx |
| T123 | Test Settings flow | WP12 | P2 | No | E2E test |
| T124 | Create app/layout.tsx nav | WP13 | P0 | No | app/layout.tsx |
| T125 | Create navigation.tsx | WP13 | P0 | Yes | components/navigation.tsx |
| T126 | Routing with Link | WP13 | P0 | No | All pages |
| T127 | Breadcrumbs component | WP13 | P0 | Yes | components/breadcrumbs.tsx |
| T128 | Zustand state persistence | WP13 | P0 | No | lib/store/* |
| T129 | Browser back/forward | WP13 | P0 | No | Next.js routing |
| T130 | Test navigation flow | WP13 | P0 | No | E2E test |
| T131 | Verify SC-004 (state preserve) | WP13 | P0 | No | E2E test |
| T132 | Unit tests: rule-engine.ts | WP14 | P3 | Yes | __tests__/unit/rule-engine.test.ts |
| T133 | Unit tests: altnode-transform | WP14 | P3 | Yes | __tests__/unit/altnode-transform.test.ts |
| T134 | Unit tests: code-generators | WP14 | P3 | Yes | __tests__/unit/code-generators.test.ts |
| T135 | Unit tests: file-storage, library | WP14 | P3 | Yes | __tests__/unit/*.test.ts |
| T136 | Integration: import flow | WP14 | P3 | Yes | __tests__/integration/import.test.ts |
| T137 | Integration: rule creation | WP14 | P3 | Yes | __tests__/integration/rules.test.ts |
| T138 | Component tests | WP14 | P3 | Yes | __tests__/components/*.test.tsx |
| T139 | E2E: complete workflows | WP14 | P3 | Yes | __tests__/e2e/*.spec.ts |
| T140 | Validate 15 Success Criteria | WP14 | P3 | No | All test suites |
| T141 | Run full test suite | WP14 | P3 | No | npm test |
| T142 | Performance tests | WP14 | P3 | Yes | __tests__/performance/*.test.ts |

---

> This task breakdown reflects the complete multi-node library manager architecture with 5 pages, Zustand state management, FigmaToCode production patterns, and all constitutional principles enforced. Each work package has a corresponding detailed prompt file in `tasks/planned/` with exhaustive implementation guidance.
